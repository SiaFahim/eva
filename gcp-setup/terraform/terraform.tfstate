{
  "version": 4,
  "terraform_version": "1.12.2",
  "serial": 19,
  "lineage": "d77ae485-a16d-a35c-3124-1db4fe3cd123",
  "outputs": {
    "instance_external_ip": {
      "value": "34.9.120.163",
      "type": "string"
    },
    "instance_internal_ip": {
      "value": "10.0.0.2",
      "type": "string"
    },
    "instance_name": {
      "value": "eva-dev-dev",
      "type": "string"
    },
    "ssh_command": {
      "value": "gcloud compute ssh eva@eva-dev-dev --zone=us-central1-a",
      "type": "string"
    },
    "storage_bucket": {
      "value": "eva-deepseek-dev-eva-dev-data",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "google_compute_image",
      "name": "ubuntu",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "archive_size_bytes": 3859216128,
            "creation_timestamp": "2025-07-22T14:23:50.064-07:00",
            "description": "Canonical, Ubuntu, 22.04 LTS, amd64 jammy image built on 2025-07-22",
            "disk_size_gb": 10,
            "family": "ubuntu-2204-lts",
            "filter": null,
            "id": "projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20250722",
            "image_encryption_key_sha256": "",
            "image_id": "3994895977242541962",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": {},
            "licenses": [
              "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/licenses/ubuntu-2204-lts"
            ],
            "most_recent": false,
            "name": "ubuntu-2204-jammy-v20250722",
            "project": "ubuntu-os-cloud",
            "self_link": "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20250722",
            "source_disk": "",
            "source_disk_encryption_key_sha256": "",
            "source_disk_id": "",
            "source_image_id": "",
            "status": "READY"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_disk",
      "name": "eva_dev_disk",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_mode": "",
            "async_primary_disk": [],
            "creation_timestamp": "2025-08-02T15:17:53.458-07:00",
            "description": "",
            "disk_encryption_key": [],
            "disk_id": "1037323665481609342",
            "effective_labels": {
              "environment": "dev",
              "project": "eva"
            },
            "enable_confidential_compute": false,
            "guest_os_features": [],
            "id": "projects/eva-deepseek-dev/zones/us-central1-a/disks/eva-dev-dev-disk",
            "image": "",
            "label_fingerprint": "boyvBe55TWQ=",
            "labels": {
              "environment": "dev",
              "project": "eva"
            },
            "last_attach_timestamp": "",
            "last_detach_timestamp": "",
            "licenses": [],
            "name": "eva-dev-dev-disk",
            "physical_block_size_bytes": 4096,
            "project": "eva-deepseek-dev",
            "provisioned_iops": 0,
            "provisioned_throughput": 0,
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/zones/us-central1-a/disks/eva-dev-dev-disk",
            "size": 100,
            "snapshot": "",
            "source_disk": "",
            "source_disk_id": "",
            "source_image_encryption_key": [],
            "source_image_id": "",
            "source_snapshot_encryption_key": [],
            "source_snapshot_id": "",
            "storage_pool": "",
            "terraform_labels": {
              "environment": "dev",
              "project": "eva"
            },
            "timeouts": null,
            "type": "pd-ssd",
            "users": [],
            "zone": "us-central1-a"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_firewall",
      "name": "eva_internal",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [
                  "0-65535"
                ],
                "protocol": "tcp"
              },
              {
                "ports": [
                  "0-65535"
                ],
                "protocol": "udp"
              },
              {
                "ports": [],
                "protocol": "icmp"
              }
            ],
            "creation_timestamp": "2025-08-02T15:16:10.122-07:00",
            "deny": [],
            "description": "Allow internal communication",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-internal",
            "log_config": [],
            "name": "eva-dev-allow-internal",
            "network": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "priority": 1000,
            "project": "eva-deepseek-dev",
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-internal",
            "source_ranges": [
              "10.0.0.0/24"
            ],
            "source_service_accounts": [],
            "source_tags": [],
            "target_service_accounts": [],
            "target_tags": [
              "eva-dev"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_compute_network.eva_network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_firewall",
      "name": "eva_jupyter",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [
                  "8888",
                  "6006",
                  "8080"
                ],
                "protocol": "tcp"
              }
            ],
            "creation_timestamp": "2025-08-02T15:16:10.208-07:00",
            "deny": [],
            "description": "Allow access to development services",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-jupyter",
            "log_config": [],
            "name": "eva-dev-allow-jupyter",
            "network": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "priority": 1000,
            "project": "eva-deepseek-dev",
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-jupyter",
            "source_ranges": [
              "187.190.190.250/32"
            ],
            "source_service_accounts": [],
            "source_tags": [],
            "target_service_accounts": [],
            "target_tags": [
              "eva-dev"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_compute_network.eva_network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_firewall",
      "name": "eva_ssh",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [
                  "22"
                ],
                "protocol": "tcp"
              }
            ],
            "creation_timestamp": "2025-08-02T15:16:10.218-07:00",
            "deny": [],
            "description": "Allow SSH access to Eva development instances",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-ssh",
            "log_config": [],
            "name": "eva-dev-allow-ssh",
            "network": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "priority": 1000,
            "project": "eva-deepseek-dev",
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/firewalls/eva-dev-allow-ssh",
            "source_ranges": [
              "187.190.190.250/32"
            ],
            "source_service_accounts": [],
            "source_tags": [],
            "target_service_accounts": [],
            "target_tags": [
              "eva-dev"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_compute_network.eva_network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "eva_dev",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": null,
            "attached_disk": [
              {
                "device_name": "eva-dev-disk",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/zones/us-central1-a/disks/eva-dev-dev-disk"
              }
            ],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "persistent-disk-0",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "enable_confidential_compute": false,
                    "image": "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20250722",
                    "labels": {},
                    "provisioned_iops": 0,
                    "provisioned_throughput": 0,
                    "resource_manager_tags": null,
                    "size": 100,
                    "storage_pool": "",
                    "type": "pd-ssd"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/zones/us-central1-a/disks/eva-dev-dev"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Haswell",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "effective_labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-development"
            },
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/eva-deepseek-dev/zones/us-central1-a/instances/eva-dev-dev",
            "instance_id": "2151251870677676147",
            "label_fingerprint": "EVUXvpaem-I=",
            "labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-development"
            },
            "machine_type": "n1-standard-4",
            "metadata": {
              "ssh-keys": "eva:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC1mBJ6husqHq4nBpYuQvyK3fxoK9ZVBCw6gxxWwPLHEcdvBIO9NMq/PDpIq9UnOzQsisQsaj46qyI4/jcb6sJQyV02jONeOkXk1sWno9h5XM6FCcZvjMuOd8wDcfNSbXxlEHXI5lKMTZj/ehFIeRMKNBfGonmHE2qHGTCV0gOl5phM22Qw2pcAH4b5Y0bxszqH/UmJbxdOGGBUrfINn5At1gLluMlJech+3soyRuI/8z+PfadtDafsVjNQ4PK5UGtCGPZC1tUwZi0oSwVecdUjzfI+A/40V5GliJQYpLJ9o8q92F2raQkjUcTv4i7YWlTtBdvP9f4yISdAFJjA+AWhTdf1oBWBHO25AMk05VOsa1gvtGNdAwjJ2glyTW3dvkzFUYvRKmEwPBYu+57l7ayyulO1/B5/ryYC7wyrtJr9KMd6JXXau/+Lg9q0ud32lIZQ4Pb4QVUypbBJoxoGmqegxiXJUijgWa7fEI4mhH/a98NWUBSUf6EAk0vDxojNuzKLlpKMZA4U+5Gk9jn12JTF8XrX03S2s20aB9pyrEsdOhR4rPdl5Y3F44wjIhlErMCpD25t8IpGswfwXUqxj/RBJA/pIhSdwAPdmosVgoI14BxKhc/cLVcAu5W7X5pu9LrM1Yt2SnwmMFGjsaUh9uK56FSPSQ5TURkbTEyF9dZT1w== git@fahimi.me\n"
            },
            "metadata_fingerprint": "5aOjkv0o-fo=",
            "metadata_startup_script": "#!/bin/bash\n# Enhanced startup script for Eva DeepSeek-V3 development instance\n# This script sets up a complete ML development environment\n\nset -e\n\n# Configuration\nEVA_USER=\"eva\"\nCONDA_VERSION=\"latest\"\nPYTHON_VERSION=\"3.10\"\nCUDA_VERSION=\"12.4\"\n\n# Logging\nexec \u003e \u003e(tee -a /var/log/eva-startup.log)\nexec 2\u003e\u00261\necho \"$(date): Starting Eva development environment setup...\"\n\n# Update system\necho \"$(date): Updating system packages...\"\napt-get update -y\napt-get upgrade -y\n\n# Install essential packages\necho \"$(date): Installing essential packages...\"\napt-get install -y \\\n    git curl wget htop tree vim nano \\\n    build-essential software-properties-common \\\n    apt-transport-https ca-certificates gnupg lsb-release \\\n    unzip zip p7zip-full \\\n    tmux screen \\\n    rsync \\\n    jq\n\n# Install NVIDIA drivers and CUDA\necho \"$(date): Installing NVIDIA drivers and CUDA...\"\napt-get install -y ubuntu-drivers-common\nubuntu-drivers autoinstall\n\n# Add NVIDIA package repository\nwget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-keyring_1.0-1_all.deb\ndpkg -i cuda-keyring_1.0-1_all.deb\napt-get update\n\n# Install CUDA toolkit\napt-get install -y cuda-toolkit-12-4 nvidia-cuda-toolkit\n\n# Install Docker\necho \"$(date): Installing Docker...\"\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsh get-docker.sh\nrm get-docker.sh\n\n# Install NVIDIA Docker runtime\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\ncurl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg\ncurl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n\napt-get update\napt-get install -y nvidia-container-toolkit\nsystemctl restart docker\n\n# Install Google Cloud SDK\necho \"$(date): Installing Google Cloud SDK...\"\ncurl https://packages.cloud.google.com/apt/doc/apt-key.gpg | gpg --dearmor -o /usr/share/keyrings/cloud.google.gpg\necho \"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main\" | tee -a /etc/apt/sources.list.d/google-cloud-sdk.list\napt-get update\napt-get install -y google-cloud-cli\n\n# Install Miniconda\necho \"$(date): Installing Miniconda...\"\nwget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh\nbash miniconda.sh -b -p /opt/conda\nrm miniconda.sh\necho 'export PATH=\"/opt/conda/bin:$PATH\"' \u003e\u003e /etc/profile\nexport PATH=\"/opt/conda/bin:$PATH\"\n\n# Create eva user if not exists\nif ! id \"$EVA_USER\" \u0026\u003e/dev/null; then\n    echo \"$(date): Creating eva user...\"\n    useradd -m -s /bin/bash $EVA_USER\n    usermod -aG sudo,docker $EVA_USER\n    echo \"$EVA_USER ALL=(ALL) NOPASSWD:ALL\" \u003e\u003e /etc/sudoers\n    \n    # Setup SSH directory\n    mkdir -p /home/$EVA_USER/.ssh\n    chmod 700 /home/$EVA_USER/.ssh\n    chown $EVA_USER:$EVA_USER /home/$EVA_USER/.ssh\nfi\n\n# Mount additional disk\necho \"$(date): Setting up additional storage...\"\nDEVICE=\"/dev/sdb\"\nMOUNT_POINT=\"/home/$EVA_USER/workspace\"\n\nif [ -b \"$DEVICE\" ]; then\n    # Format disk if not already formatted\n    if ! blkid $DEVICE; then\n        mkfs.ext4 $DEVICE\n    fi\n    \n    # Create mount point and mount\n    mkdir -p $MOUNT_POINT\n    mount $DEVICE $MOUNT_POINT\n    \n    # Add to fstab for persistent mounting\n    echo \"$DEVICE $MOUNT_POINT ext4 defaults 0 2\" \u003e\u003e /etc/fstab\n    \n    # Set ownership\n    chown -R $EVA_USER:$EVA_USER $MOUNT_POINT\nfi\n\n# Setup conda environment for eva user\necho \"$(date): Setting up conda environment...\"\nsudo -u $EVA_USER bash \u003c\u003c 'CONDA_SETUP'\nexport PATH=\"/opt/conda/bin:$PATH\"\n\n# Create eva environment\nconda create -n eva python=3.10 -y\nsource activate eva\n\n# Install core ML packages\npip install --upgrade pip\n\n# PyTorch with CUDA support\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121\n\n# TensorFlow with GPU support\npip install tensorflow[and-cuda]==2.15.0\n\n# Hugging Face ecosystem\npip install transformers datasets tokenizers accelerate\n\n# Development tools\npip install jupyterlab==4.0.7 notebook\npip install ipywidgets jupyter_contrib_nbextensions\n\n# Scientific computing\npip install numpy pandas matplotlib seaborn plotly\npip install scikit-learn scipy\n\n# ML utilities\npip install wandb tensorboard\npip install mlflow optuna\n\n# Development and testing\npip install pytest black isort flake8 mypy\npip install pre-commit\n\n# DeepSpeed for distributed training\npip install deepspeed\n\n# Additional ML libraries\npip install xformers  # Memory efficient transformers\npip install flash-attn  # Flash attention implementation\n\n# Create activation script\ncat \u003e /home/eva/activate_env.sh \u003c\u003c 'ACTIVATE_EOF'\n#!/bin/bash\nexport PATH=\"/opt/conda/bin:$PATH\"\nconda activate eva\n\n# CUDA environment variables\nexport CUDA_VISIBLE_DEVICES=0\nexport TF_CPP_MIN_LOG_LEVEL=1\nexport PYTHONPATH=\"${PYTHONPATH}:$(pwd)\"\n\n# Hugging Face cache\nexport HF_HOME=\"/home/eva/workspace/.cache/huggingface\"\nexport TRANSFORMERS_CACHE=\"/home/eva/workspace/.cache/huggingface/transformers\"\n\necho \"🧠 Eva development environment activated\"\necho \"Python: $(python --version)\"\necho \"PyTorch: $(python -c 'import torch; print(torch.__version__)')\"\necho \"CUDA available: $(python -c 'import torch; print(torch.cuda.is_available())')\"\nif command -v nvidia-smi \u0026\u003e /dev/null; then\n    nvidia-smi --query-gpu=name,memory.total,memory.free --format=csv,noheader,nounits\nfi\nACTIVATE_EOF\n\nchmod +x /home/eva/activate_env.sh\nCONDA_SETUP\n\n# Setup Jupyter Lab\necho \"$(date): Configuring Jupyter Lab...\"\nsudo -u $EVA_USER bash \u003c\u003c 'JUPYTER_SETUP'\nexport PATH=\"/opt/conda/bin:$PATH\"\nsource activate eva\n\n# Generate Jupyter config\njupyter lab --generate-config\n\n# Create Jupyter config\ncat \u003e /home/eva/.jupyter/jupyter_lab_config.py \u003c\u003c 'JUPYTER_CONFIG'\nc.ServerApp.ip = '0.0.0.0'\nc.ServerApp.port = 8888\nc.ServerApp.open_browser = False\nc.ServerApp.allow_root = False\nc.ServerApp.token = ''\nc.ServerApp.password = ''\nc.ServerApp.allow_remote_access = True\nc.ServerApp.notebook_dir = '/home/eva/workspace'\nJUPYTER_CONFIG\n\n# Install Jupyter extensions\njupyter labextension install @jupyter-widgets/jupyterlab-manager\nJUPYTER_SETUP\n\n# Setup auto-shutdown script\necho \"$(date): Setting up auto-shutdown...\"\ncat \u003e /home/$EVA_USER/auto-shutdown.sh \u003c\u003c 'SHUTDOWN_EOF'\n#!/bin/bash\n# Auto-shutdown if no active sessions for 30 minutes\n\nIDLE_TIME=30  # minutes\nLOG_FILE=\"/var/log/auto-shutdown.log\"\n\n# Check for active SSH sessions\nACTIVE_SESSIONS=$(who | wc -l)\n\n# Check for running Jupyter processes\nJUPYTER_PROCESSES=$(pgrep -f jupyter | wc -l)\n\n# Check for GPU utilization\nGPU_UTIL=0\nif command -v nvidia-smi \u0026\u003e /dev/null; then\n    GPU_UTIL=$(nvidia-smi --query-gpu=utilization.gpu --format=csv,noheader,nounits | head -1)\nfi\n\necho \"$(date): Sessions: $ACTIVE_SESSIONS, Jupyter: $JUPYTER_PROCESSES, GPU: $GPU_UTIL%\" \u003e\u003e $LOG_FILE\n\n# Shutdown if no activity\nif [ $ACTIVE_SESSIONS -eq 0 ] \u0026\u0026 [ $JUPYTER_PROCESSES -eq 0 ] \u0026\u0026 [ $GPU_UTIL -lt 5 ]; then\n    echo \"$(date): No activity detected. Scheduling shutdown in $IDLE_TIME minutes.\" \u003e\u003e $LOG_FILE\n    shutdown -h +$IDLE_TIME \"Auto-shutdown: No active development sessions detected\"\nelse\n    echo \"$(date): Activity detected. Cancelling any pending shutdowns.\" \u003e\u003e $LOG_FILE\n    shutdown -c 2\u003e/dev/null || true\nfi\nSHUTDOWN_EOF\n\nchmod +x /home/$EVA_USER/auto-shutdown.sh\n\n# Add to crontab for eva user\nsudo -u $EVA_USER bash -c 'echo \"*/15 * * * * /home/eva/auto-shutdown.sh\" | crontab -'\n\n# Setup systemd service for Jupyter\ncat \u003e /etc/systemd/system/eva-jupyter.service \u003c\u003c 'SERVICE_EOF'\n[Unit]\nDescription=Eva Jupyter Lab\nAfter=network.target\n\n[Service]\nType=simple\nUser=eva\nWorkingDirectory=/home/eva/workspace\nEnvironment=PATH=/opt/conda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nExecStart=/bin/bash -c 'source /opt/conda/bin/activate eva \u0026\u0026 jupyter lab'\nRestart=always\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\nSERVICE_EOF\n\nsystemctl daemon-reload\nsystemctl enable eva-jupyter.service\n\n# Create workspace directories\necho \"$(date): Setting up workspace directories...\"\nsudo -u $EVA_USER mkdir -p /home/$EVA_USER/workspace/{projects,datasets,models,notebooks,scripts}\n\n# Set proper ownership\nchown -R $EVA_USER:$EVA_USER /home/$EVA_USER/\n\n# Create welcome script\ncat \u003e /home/$EVA_USER/welcome.sh \u003c\u003c 'WELCOME_EOF'\n#!/bin/bash\necho \"🚀 Welcome to Eva DeepSeek-V3 Development Environment!\"\necho \"==================================================\"\necho \"\"\necho \"Quick Start:\"\necho \"1. Activate environment: source ~/activate_env.sh\"\necho \"2. Start Jupyter Lab: jupyter lab (or systemctl start eva-jupyter)\"\necho \"3. Access Jupyter at: http://$(curl -s ifconfig.me):8888\"\necho \"\"\necho \"Useful commands:\"\necho \"- Check GPU: nvidia-smi\"\necho \"- Monitor resources: htop\"\necho \"- Sync files: gsutil rsync -r gs://your-bucket/ ~/workspace/\"\necho \"\"\necho \"Directories:\"\necho \"- ~/workspace/projects/ - Your code projects\"\necho \"- ~/workspace/datasets/ - Training datasets\"\necho \"- ~/workspace/models/ - Model checkpoints\"\necho \"- ~/workspace/notebooks/ - Jupyter notebooks\"\necho \"\"\necho \"Happy coding! 🧠✨\"\nWELCOME_EOF\n\nchmod +x /home/$EVA_USER/welcome.sh\n\n# Add welcome to bashrc\necho \"source /home/$EVA_USER/welcome.sh\" \u003e\u003e /home/$EVA_USER/.bashrc\n\necho \"$(date): Eva development environment setup completed successfully!\"\necho \"$(date): Instance is ready for DeepSeek-V3 development.\"\n\n# Start Jupyter service\nsystemctl start eva-jupyter.service\n\n# Final system info\necho \"$(date): System Information:\"\necho \"- OS: $(lsb_release -d | cut -f2)\"\necho \"- Kernel: $(uname -r)\"\necho \"- CUDA: $(nvcc --version | grep release | cut -d' ' -f5-6)\"\necho \"- Docker: $(docker --version)\"\necho \"- Python: $(python3 --version)\"\n\nif command -v nvidia-smi \u0026\u003e /dev/null; then\n    echo \"- GPU Info:\"\n    nvidia-smi --query-gpu=name,memory.total --format=csv,noheader\nfi\n\necho \"$(date): Setup completed. Rebooting to ensure all drivers are loaded...\"\nreboot\n",
            "min_cpu_platform": "",
            "name": "eva-dev-dev",
            "network_interface": [
              {
                "access_config": [
                  {
                    "nat_ip": "34.9.120.163",
                    "network_tier": "PREMIUM",
                    "public_ptr_domain_name": ""
                  }
                ],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
                "network_ip": "10.0.0.2",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/regions/us-central1/subnetworks/eva-dev-subnet",
                "subnetwork_project": "eva-deepseek-dev"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "eva-deepseek-dev",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": false,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "max_run_duration": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "TERMINATE",
                "on_instance_stop_action": [],
                "preemptible": true,
                "provisioning_model": ""
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/zones/us-central1-a/instances/eva-dev-dev",
            "service_account": [
              {
                "email": "eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": false,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "eva-dev"
            ],
            "tags_fingerprint": "ZWXShAutUGw=",
            "terraform_labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-development"
            },
            "timeouts": null,
            "zone": "us-central1-a"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "attached_disk"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "disk_encryption_key_raw"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "boot_disk"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "disk_encryption_key_raw"
              }
            ]
          ],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "data.google_compute_image.ubuntu",
            "google_compute_disk.eva_dev_disk",
            "google_compute_network.eva_network",
            "google_compute_subnetwork.eva_subnet",
            "google_service_account.eva_compute"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_network",
      "name": "eva_network",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "auto_create_subnetworks": false,
            "delete_default_routes_on_create": false,
            "description": "Eva DeepSeek-V3 development network",
            "enable_ula_internal_ipv6": false,
            "gateway_ipv4": "",
            "id": "projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "internal_ipv6_range": "",
            "mtu": 0,
            "name": "eva-dev-network",
            "network_firewall_policy_enforcement_order": "AFTER_CLASSIC_FIREWALL",
            "numeric_id": "6989429759644217585",
            "project": "eva-deepseek-dev",
            "routing_mode": "REGIONAL",
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_subnetwork",
      "name": "eva_subnet",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "creation_timestamp": "2025-08-02T15:16:10.237-07:00",
            "description": "Eva development subnet",
            "external_ipv6_prefix": "",
            "fingerprint": null,
            "gateway_address": "10.0.0.1",
            "id": "projects/eva-deepseek-dev/regions/us-central1/subnetworks/eva-dev-subnet",
            "internal_ipv6_prefix": "",
            "ip_cidr_range": "10.0.0.0/24",
            "ipv6_access_type": "",
            "ipv6_cidr_range": "",
            "log_config": [],
            "name": "eva-dev-subnet",
            "network": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/global/networks/eva-dev-network",
            "private_ip_google_access": false,
            "private_ipv6_google_access": "DISABLE_GOOGLE_ACCESS",
            "project": "eva-deepseek-dev",
            "purpose": "PRIVATE",
            "region": "us-central1",
            "role": "",
            "secondary_ip_range": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/eva-deepseek-dev/regions/us-central1/subnetworks/eva-dev-subnet",
            "send_secondary_ip_range_if_empty": null,
            "stack_type": "IPV4_ONLY",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_compute_network.eva_network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_iam_member",
      "name": "eva_compute_logging",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwY7aTjqAwk=",
            "id": "eva-deepseek-dev/roles/logging.logWriter/serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "member": "serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "project": "eva-deepseek-dev",
            "role": "roles/logging.logWriter"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "google_service_account.eva_compute"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_iam_member",
      "name": "eva_compute_monitoring",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwY7aTjqAwk=",
            "id": "eva-deepseek-dev/roles/monitoring.metricWriter/serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "member": "serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "project": "eva-deepseek-dev",
            "role": "roles/monitoring.metricWriter"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "google_service_account.eva_compute"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_iam_member",
      "name": "eva_compute_storage",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwY7aTjqAwk=",
            "id": "eva-deepseek-dev/roles/storage.admin/serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "member": "serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "project": "eva-deepseek-dev",
            "role": "roles/storage.admin"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "google_service_account.eva_compute"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_service_account",
      "name": "eva_compute",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "eva-dev-compute",
            "create_ignore_already_exists": null,
            "description": "Service account for Eva development instances",
            "disabled": false,
            "display_name": "Eva Development Compute Service Account",
            "email": "eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "id": "projects/eva-deepseek-dev/serviceAccounts/eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "member": "serviceAccount:eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "name": "projects/eva-deepseek-dev/serviceAccounts/eva-dev-compute@eva-deepseek-dev.iam.gserviceaccount.com",
            "project": "eva-deepseek-dev",
            "timeouts": null,
            "unique_id": "101575313416243713520"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_storage_bucket",
      "name": "eva_data",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "autoclass": [],
            "cors": [],
            "custom_placement_config": [],
            "default_event_based_hold": false,
            "effective_labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-data"
            },
            "enable_object_retention": false,
            "encryption": [],
            "force_destroy": false,
            "id": "eva-deepseek-dev-eva-dev-data",
            "labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-data"
            },
            "lifecycle_rule": [
              {
                "action": [
                  {
                    "storage_class": "",
                    "type": "Delete"
                  }
                ],
                "condition": [
                  {
                    "age": 90,
                    "created_before": "",
                    "custom_time_before": "",
                    "days_since_custom_time": 0,
                    "days_since_noncurrent_time": 0,
                    "matches_prefix": [],
                    "matches_storage_class": [],
                    "matches_suffix": [],
                    "no_age": false,
                    "noncurrent_time_before": "",
                    "num_newer_versions": 0,
                    "send_age_if_zero": true,
                    "send_days_since_custom_time_if_zero": false,
                    "send_days_since_noncurrent_time_if_zero": false,
                    "send_num_newer_versions_if_zero": false,
                    "with_state": "ANY"
                  }
                ]
              }
            ],
            "location": "US-CENTRAL1",
            "logging": [],
            "name": "eva-deepseek-dev-eva-dev-data",
            "project": "eva-deepseek-dev",
            "project_number": 828903300090,
            "public_access_prevention": "inherited",
            "requester_pays": false,
            "retention_policy": [],
            "rpo": null,
            "self_link": "https://www.googleapis.com/storage/v1/b/eva-deepseek-dev-eva-dev-data",
            "soft_delete_policy": [
              {
                "effective_time": "2025-08-02T22:15:58.700Z",
                "retention_duration_seconds": 604800
              }
            ],
            "storage_class": "STANDARD",
            "terraform_labels": {
              "environment": "dev",
              "project": "eva",
              "purpose": "ml-data"
            },
            "timeouts": null,
            "uniform_bucket_level_access": true,
            "url": "gs://eva-deepseek-dev-eva-dev-data",
            "versioning": [
              {
                "enabled": true
              }
            ],
            "website": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsInJlYWQiOjI0MDAwMDAwMDAwMCwidXBkYXRlIjoyNDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ=="
        }
      ]
    }
  ],
  "check_results": null
}
